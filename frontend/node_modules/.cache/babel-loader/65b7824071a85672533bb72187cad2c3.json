{"ast":null,"code":"import _slicedToArray from\"/Users/jucenirleonardo/Documents/GitHub/whaticket_saas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/jucenirleonardo/Documents/GitHub/whaticket_saas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/jucenirleonardo/Documents/GitHub/whaticket_saas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useContext,useEffect}from\"react\";import clsx from\"clsx\";import{makeStyles,Drawer,AppBar,Toolbar,List,Typography,Divider,MenuItem,IconButton,Menu,useTheme,useMediaQuery}from\"@material-ui/core\";import MenuIcon from\"@material-ui/icons/Menu\";import ChevronLeftIcon from\"@material-ui/icons/ChevronLeft\";import AccountCircle from\"@material-ui/icons/AccountCircle\";import MainListItems from\"./MainListItems\";import NotificationsPopOver from\"../components/NotificationsPopOver\";import UserModal from\"../components/UserModal\";import{AuthContext}from\"../context/Auth/AuthContext\";import BackdropLoading from\"../components/BackdropLoading\";import{i18n}from\"../translate/i18n\";import toastError from\"../errors/toastError\";import AnnouncementsPopover from\"../components/AnnouncementsPopover\";import logo from\"../assets/zapsimples.png\";import{socketConnection}from\"../services/socket\";import ChatPopover from\"../pages/Chat/ChatPopover\";var drawerWidth=300;var useStyles=makeStyles(function(theme){return{root:_defineProperty({display:\"flex\",height:\"100vh\"},theme.breakpoints.down(\"sm\"),{height:\"calc(100vh - 56px)\"}),toolbar:{paddingRight:24,// keep right padding when drawer closed\ncolor:\"#FFFFFF\",background:theme.barraSuperior.primary.main},toolbarIcon:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",padding:\"0 8px\",minHeight:\"48px\"},appBar:{zIndex:theme.zIndex.drawer+1,transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen})},appBarShift:{marginLeft:drawerWidth,width:\"calc(100% - \".concat(drawerWidth,\"px)\"),transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:\"none\"},title:{flexGrow:1,fontSize:14},drawerPaper:{backgroundColor:theme.barraLateral.primary.main,position:\"relative\",whiteSpace:\"nowrap\",width:drawerWidth,transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen})},drawerPaperClose:_defineProperty({overflowX:\"hidden\",transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen}),width:theme.spacing(7)},theme.breakpoints.up(\"sm\"),{width:theme.spacing(9)}),appBarSpacer:{minHeight:\"48px\"},content:_objectSpread({flex:1,overflow:\"auto\"},theme.scrollbarStyles),container:{paddingTop:theme.spacing(4),paddingBottom:theme.spacing(4)},paper:{padding:theme.spacing(2),display:\"flex\",overflow:\"auto\",flexDirection:\"column\"},containerWithScroll:_objectSpread({flex:1,padding:theme.spacing(1),overflowY:\"scroll\"},theme.scrollbarStyles)};});var LoggedInLayout=function LoggedInLayout(_ref){var children=_ref.children;var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),userModalOpen=_useState2[0],setUserModalOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorEl=_useState4[0],setAnchorEl=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),menuOpen=_useState6[0],setMenuOpen=_useState6[1];var _useContext=useContext(AuthContext),handleLogout=_useContext.handleLogout,loading=_useContext.loading;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),drawerOpen=_useState8[0],setDrawerOpen=_useState8[1];var _useState9=useState(\"permanent\"),_useState10=_slicedToArray(_useState9,2),drawerVariant=_useState10[0],setDrawerVariant=_useState10[1];var _useContext2=useContext(AuthContext),user=_useContext2.user;var theme=useTheme();var greaterThenSm=useMediaQuery(theme.breakpoints.up(\"sm\"));useEffect(function(){if(document.body.offsetWidth>600){setDrawerOpen(true);}},[]);useEffect(function(){if(document.body.offsetWidth<600){setDrawerVariant(\"temporary\");}else{setDrawerVariant(\"permanent\");}},[drawerOpen]);useEffect(function(){var companyId=localStorage.getItem(\"companyId\");var userId=localStorage.getItem(\"userId\");var socket=socketConnection({companyId:companyId});socket.on(\"company-\".concat(companyId,\"-auth\"),function(data){if(data.user.id===+userId){toastError(\"Sua conta foi acessada em outro computador.\");setTimeout(function(){localStorage.clear();window.location.reload();},1000);}});socket.emit(\"userStatus\");var interval=setInterval(function(){socket.emit(\"userStatus\");},1000*60*5);return function(){socket.disconnect();clearInterval(interval);};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleMenu=function handleMenu(event){setAnchorEl(event.currentTarget);setMenuOpen(true);};var handleCloseMenu=function handleCloseMenu(){setAnchorEl(null);setMenuOpen(false);};var handleOpenUserModal=function handleOpenUserModal(){setUserModalOpen(true);handleCloseMenu();};var handleClickLogout=function handleClickLogout(){handleCloseMenu();handleLogout();};var drawerClose=function drawerClose(){if(document.body.offsetWidth<600){setDrawerOpen(false);}};if(loading){return/*#__PURE__*/React.createElement(BackdropLoading,null);}return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Drawer,{variant:drawerVariant,className:drawerOpen?classes.drawerPaper:classes.drawerPaperClose,classes:{paper:clsx(classes.drawerPaper,!drawerOpen&&classes.drawerPaperClose)},open:drawerOpen},/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbarIcon},/*#__PURE__*/React.createElement(\"img\",{src:logo,style:{margin:\"0 auto\",height:\"50px\",width:\"100%\"},alt:\"logo\"}),/*#__PURE__*/React.createElement(IconButton,{onClick:function onClick(){return setDrawerOpen(!drawerOpen);}},/*#__PURE__*/React.createElement(ChevronLeftIcon,null))),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(List,{className:classes.containerWithScroll},/*#__PURE__*/React.createElement(MainListItems,{drawerClose:drawerClose})),/*#__PURE__*/React.createElement(Divider,null)),/*#__PURE__*/React.createElement(UserModal,{open:userModalOpen,onClose:function onClose(){return setUserModalOpen(false);},userId:user===null||user===void 0?void 0:user.id}),/*#__PURE__*/React.createElement(AppBar,{position:\"absolute\",className:clsx(classes.appBar,drawerOpen&&classes.appBarShift),color:\"primary\"},/*#__PURE__*/React.createElement(Toolbar,{variant:\"dense\",className:classes.toolbar},/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",variant:\"contained\",\"aria-label\":\"open drawer\",onClick:function onClick(){return setDrawerOpen(!drawerOpen);},className:clsx(classes.menuButton,drawerOpen&&classes.menuButtonHidden)},/*#__PURE__*/React.createElement(MenuIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h8\",variant:\"h8\",color:\"#FFFFFF\",noWrap:true,className:classes.title},greaterThenSm?/*#__PURE__*/React.createElement(React.Fragment,null,\"Ol\\xE1 \",/*#__PURE__*/React.createElement(\"b\",null,user.name),\", Seja bem-vindo.\"):user.name),user.id&&/*#__PURE__*/React.createElement(NotificationsPopOver,null),/*#__PURE__*/React.createElement(AnnouncementsPopover,null),/*#__PURE__*/React.createElement(ChatPopover,null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"account of current user\",\"aria-controls\":\"menu-appbar\",\"aria-haspopup\":\"true\",onClick:handleMenu,variant:\"contained\"},/*#__PURE__*/React.createElement(AccountCircle,null)),/*#__PURE__*/React.createElement(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleCloseMenu},/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenUserModal},i18n.t(\"mainDrawer.appBar.user.profile\")),/*#__PURE__*/React.createElement(MenuItem,{onClick:handleClickLogout},i18n.t(\"mainDrawer.appBar.user.logout\")))))),/*#__PURE__*/React.createElement(\"main\",{className:classes.content},/*#__PURE__*/React.createElement(\"div\",{className:classes.appBarSpacer}),children?children:null));};export default LoggedInLayout;","map":null,"metadata":{},"sourceType":"module"}